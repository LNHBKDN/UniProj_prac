use _NET
go

CREATE TABLE LSH (
	ID_LOP INT PRIMARY KEY,
	NAMELOP NVARCHAR(50) 
)
GO

CREATE TABLE SV1 (
	MSSV VARCHAR(50) PRIMARY KEY NOT NULL,
	NAMESV NVARCHAR(50),
	GENDER BIT,
	NGAYSINH DATE,
	DTB FLOAT,
	ID_LOP INT,
	FOREIGN KEY (ID_LOP) REFERENCES LSH(ID_LOP)
)
GO

INSERT INTO LSH (ID_LOP, NAMELOP) VALUES (101,N'21TCLC_DT1')
GO
INSERT INTO LSH (ID_LOP, NAMELOP) VALUES (102,N'21TCLC_DT2')
GO
INSERT INTO LSH (ID_LOP, NAMELOP) VALUES (103,N'21TCLC_DT3')
GO
INSERT INTO LSH (ID_LOP, NAMELOP) VALUES (104,N'21TCLC_DT4')
GO
INSERT INTO LSH (ID_LOP, NAMELOP) VALUES (105,N'21T')
GO

INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1001',N'NV A', 1,'1993-12-1',9.8,101)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1002',N'NV B', 1,'1994-11-2',9.3,101)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1003',N'NV C', 0,'1997-12-7',8.8,101)
GO

INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1005',N'TV A', 0,'2000-7-4',6.8,102)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1006',N'TV B', 1,'2000-1-24',7.3,102)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1007',N'TV C', 0,'1997-6-7',8.8,102)
GO

INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1011',N'BV A', 1,'2001-12-21',7.8,103)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1012',N'BV B', 0,'2001-1-22',9.6,103)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1013',N'BV C', 1,'2001-9-27',9.8,103)
GO

INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1021',N'KV A', 0,'2003-2-15',7.8,104)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1022',N'KV B', 1,'2003-9-22',4.3,104)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1023',N'KV C', 0,'2003-1-6',6.8,104)
GO

INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1029',N'HV A', 0,'2002-7-15',8.8,105)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1028',N'HV B', 1,'2002-6-22',5.3,105)
GO
INSERT INTO SV1 (MSSV, NAMESV , GENDER, NGAYSINH, DTB, ID_LOP) VALUES ('1027',N'HV C', 1,'2002-3-6',6.6,105)
GO

SELECT SV1.MSSV, SV1.NAMESV, LSH.NAMELOP, SV1.GENDER, SV1.NGAYSINH, SV1.DTB
FROM SV1
INNER JOIN LSH  ON SV1.ID_LOP = LSH.ID_LOP
ORDER BY DTB  DESC;
